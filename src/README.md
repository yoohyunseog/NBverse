# N/B CCTV 감시 시스템

실시간 CCTV 카메라 모니터링 및 분석 웹 애플리케이션입니다.

## 주요 기능

### 📹 카메라 관리
- **다중 카메라 지원**: 무제한 카메라 동시 모니터링
- **다양한 스트림 형식 지원**:
  - HTTP/MJPEG 스트림
  - HLS 스트림 (.m3u8)
  - 일반 비디오 파일 (MP4 등)
  - 공공 CCTV 웹사이트 (iframe)
- **Masonry 레이아웃**: 자동 정렬되는 반응형 그리드 레이아웃
- **카메라 관리**: 추가, 수정, 삭제, 일괄 추가 기능
- **로컬 저장**: 브라우저 로컬 스토리지에 카메라 설정 자동 저장

### 🔢 BIT 계산 시스템
- **BIT MAX/MIN 계산**: 실시간 비디오 프레임 분석을 통한 BIT 값 계산
- **평균값 계산**: 10초, 30초, 60초 평균 BIT 값 표시
- **순위별 색상 표시**: BIT MAX 값 기준 순위에 따라 빨간색(1위) ~ 흰색(하위) 색상 적용
- **BIT 배열 표시**: 계산된 BIT 배열 데이터 표시

### 📊 실시간 분석
- **모션 감지**: OpenCV.js를 활용한 움직임 감지
- **객체 추적**: 감지된 객체의 바운딩 박스 표시
- **배경 분석**: 밝기, 대비, 안정성 분석
- **좌측 사이드바**: 모든 카메라의 분석 결과를 한눈에 확인

### ⚡ 자동화 기능
- **실시간 정렬**: BIT MAX 값 기준 자동 정렬 (10초/30초/60초 평균)
- **타이머 시스템**:
  - 반복 초 타이머 (실시간 정렬 간격 조절)
  - Masonry 재정렬 타이머
  - 바운딩 박스 초기화 타이머
- **막대 게이지**: 각 타이머의 진행 상태를 색상별 게이지로 표시
- **자동 저장/로드**: 타이머 설정값 자동 저장 및 복원

### 🎨 사용자 인터페이스
- **전체화면 보기**: 개별 카메라를 전체화면으로 확대
- **정렬 기능**: BIT MAX/MIN 값 기준 정렬
- **Masonry 정렬**: 레이아웃 수동 재정렬 버튼
- **반응형 디자인**: 다양한 화면 크기 지원

## 사용 방법

### 기본 사용
1. `index.html` 파일을 브라우저에서 엽니다.
2. 기본적으로 N/B CCTV 카메라들이 표시됩니다.
3. **카메라 추가** 버튼을 클릭하여 새로운 카메라를 추가합니다.
4. 각 카메라의 **수정** 버튼으로 카메라 정보를 변경할 수 있습니다.
5. **확대** 버튼으로 전체화면으로 카메라를 볼 수 있습니다.

### 타이머 사용
1. **반복 초** 입력란에 실시간 정렬 간격을 설정합니다 (기본값: 2초)
2. **Masonry 재정렬 타이머** 입력란에 재정렬 간격을 설정합니다 (기본값: 5초)
3. **영상 객체 박스 초기화 타이머** 입력란에 초기화 간격을 설정합니다 (기본값: 10초)
4. 실시간 정렬 버튼(10초/30초/60초) 중 하나를 선택합니다
5. **타이머 시작** 버튼을 클릭하여 모든 타이머를 시작합니다
6. 각 타이머의 진행 상태는 색상별 막대 게이지로 확인할 수 있습니다

### 정렬 기능
- **MAX 높은 순**: BIT MAX 값이 높은 순으로 정렬
- **MIN 높은 순**: BIT MIN 값이 높은 순으로 정렬
- **실시간 MAX 정렬**: 선택한 시간(10초/30초/60초)의 평균값 기준 자동 정렬
- **Masonry 정렬**: 레이아웃을 수동으로 재정렬

## 카메라 URL 형식

### HTTP/MJPEG 스트림
```
http://카메라IP:포트/video
http://카메라IP:포트/mjpeg
```

### HLS 스트림
```
http://카메라IP:포트/stream.m3u8
https://its.gumi.go.kr:9443/live/video59.stream/chunklist_w78320174.m3u8
```

### 스냅샷 (정적 이미지)
```
http://카메라IP:포트/snapshot.jpg
```

### 일반 비디오
```
http://서버/비디오파일.mp4
```

### 공공 CCTV 웹사이트
```
https://www.utic.go.kr/map/map.do
```

## 좌측 사이드바 정보

좌측 사이드바에서 각 카메라의 다음 정보를 확인할 수 있습니다:
- **BIT MAX**: 최대 BIT 값 (순위별 색상 표시)
- **BIT MIN**: 최소 BIT 값
- **평균 (10초)**: 10초 평균 BIT 값
- **평균 (30초)**: 30초 평균 BIT 값
- **평균 (60초)**: 60초 평균 BIT 값
- **움직임**: 감지된 움직임 영역 개수
- **객체**: 추적 중인 객체 개수
- **밝기**: 평균 밝기 값
- **안정성**: 배경 안정성 (%)

## 기술 스택

- **HTML5**: 구조 및 마크업
- **CSS3**: Grid Layout, Flexbox, 애니메이션
- **Vanilla JavaScript**: 모든 로직 구현
- **OpenCV.js**: 비디오 프레임 분석 및 객체 추적
- **HLS.js**: HLS 스트림 재생
- **Masonry.js**: 반응형 그리드 레이아웃
- **LocalStorage API**: 설정 및 데이터 저장
- **BIT 계산 스크립트**: 외부 BIT 계산 라이브러리

## 브라우저 호환성

- **Chrome/Edge** (권장)
- **Firefox**
- **Safari**
- **Opera**

## 주요 특징

### BIT 계산 시스템
- 실시간 비디오 프레임을 분석하여 BIT 값 계산
- BIT MAX/MIN 값 추적 및 평균값 계산
- 순위별 색상 표시로 시각적 구분

### 자동화 기능
- 타이머 기반 자동 정렬 및 재정렬
- 바운딩 박스 자동 초기화
- 설정값 자동 저장 및 복원

### 사용자 경험
- 직관적인 인터페이스
- 실시간 피드백 (게이지, 색상)
- 반응형 레이아웃

## 보안 참고사항

- 실제 운영 환경에서는 HTTPS를 사용하세요.
- 카메라 인증 정보는 안전하게 관리하세요.
- CORS 설정이 필요한 경우 서버에서 허용해야 합니다.

## 문제 해결

### 카메라가 표시되지 않는 경우
1. 카메라 URL이 올바른지 확인
2. 네트워크 연결 확인
3. 브라우저 콘솔에서 오류 메시지 확인
4. CORS 문제인 경우 서버 설정 확인

### BIT 계산이 되지 않는 경우
1. 비디오가 정상적으로 로드되었는지 확인
2. OpenCV.js가 로드되었는지 확인 (콘솔 메시지 확인)
3. 브라우저 콘솔에서 오류 메시지 확인

### 타이머가 작동하지 않는 경우
1. "타이머 시작" 버튼을 눌렀는지 확인
2. 실시간 정렬 버튼이 활성화되어 있는지 확인
3. 입력값이 올바른지 확인 (1 이상의 숫자)

## 라이선스

이 프로젝트는 자유롭게 사용 가능합니다.

---

**N/B CCTV 감시 시스템** | 개발 중
